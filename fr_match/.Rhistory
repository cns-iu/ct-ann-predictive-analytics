# FR-Match
library(FRmatch)
library(SingleCellExperiment)
library(dplyr)
library(tibble)
library(data.table)
## read in pieces of input data - this may take a few minutes
cell_cluster_labels <- fread("../Datasets/TS_Lung/azimuth_preds.tsv",  sep=" ") %>%
select(c(V1, predicted.ann_finest_level)) %>%
rename(c(Sample=V1, Cluster=predicted.ann_finest_level))
cell_cluster_labels
cell_by_gene_expression <- fread("../Datasets/TS_Lung/SingleCellExperiment_src_files/cell_by_gene_expression.csv") %>%
mutate(Sample=cell_cluster_labels$Sample)
NSForest_marker_genes <- fread("../Datasets/TS_Lung/NSForest_markers.csv")
unique_markers <- unique(NSForest_marker_genes$markerGene)
names(cell_by_gene_expression)[1]
cell_by_gene_expression <- fread("../Datasets/TS_Lung/SingleCellExperiment_src_files/cell_by_gene_expression.csv") %>%
mutate(Sample=cell_cluster_labels$Sample) %>%
select("Sample", everything())
names(cell_by_gene_expression)[1]
unique_markers <- unique(NSForest_marker_genes$markerGene)
unique_markers
# Use the make_data_object() function to compile the pieces of input data into a data object.
sce_dataset <- make_data_object(
dat = cell_by_gene_expression,
tab = cell_cluster_labels,
markers = unique_markers,
## below are optional input data
cluster_marker_info = NSForest_marker_genes,
# f_score = NSForest_fscores,
# cluster_order = MTG_taxonomy
)
library(FRmatch)
library(SingleCellExperiment)
library(dplyr)
library(tibble)
library(data.table)
## read in pieces of input data - this may take a few minutes
cell_cluster_labels <- fread("../Datasets/TS_Lung/azimuth_preds.tsv",  sep=" ") %>%
select(c(V1, predicted.ann_finest_level)) %>%
rename(c(Sample=V1, Cluster=predicted.ann_finest_level))
cell_by_gene_expression <- fread("../Datasets/TS_Lung/SingleCellExperiment_src_files/cell_by_gene_expression.csv") %>%
mutate(Sample=cell_cluster_labels$Sample) %>%
select("Sample", everything())
NSForest_marker_genes <- fread("../Datasets/TS_Lung/NSForest_markers.csv")
# NSForest_fscores <- fread("NSForest_fscores.csv")
# MTG_taxonomy <- fread("MTG_taxonomy.csv")$x #need to be a vector
unique_markers <- unique(NSForest_marker_genes$markerGene)
# Use the make_data_object() function to compile the pieces of input data into a data object.
sce_dataset <- make_data_object(
dat = cell_by_gene_expression,
tab = cell_cluster_labels,
markers = unique_markers,
## below are optional input data
cluster_marker_info = NSForest_marker_genes,
# f_score = NSForest_fscores,
# cluster_order = MTG_taxonomy
)
memory.limit()
gc()
adata <- zellkonverter::readH5AD(file='../Datasets/TS_Lung/TS_Lung_predictions_anndata.h5ad')
